<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="jumbotron text-center">
        <h1>Do this survey</h1>
    </div>
    <div class="d-flex justify-content-center">
        <form id="friendForm" class="d-flex flex-column " action="/api/friends" method="POST">

            <input id="inputName" type="text" name="name" value="" placeholder="Name Here">
            <input id="pictureUrl" type="text" name="photo" value="" placeholder="Picture URL Here">
            (1 strongly disagree -- 5 strongly agree)
            <fieldset id="firstQ" class="form-group">
                <legend class="pt-0 ">Doge is best doge</legend>

                <input type="radio" name="score[0]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[0]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[0]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[0]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[0]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>

            <fieldset id="secondeQ" class="form-group ">
                <legend class="pt-0 ">Whens mahvel?</legend>

                <input type="radio" name="score[1]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[1]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[1]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[1]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[1]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">Did you reach your final form?</legend>

                <input type="radio" name="score[2]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[2]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[2]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[2]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[2]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">You have 100 pounds of feathers and 100 pounds of rocks which one is heavier?</legend>

                <input type="radio" name="score[3]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[3]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[3]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[3]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[3]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>

            <fieldset class="form-group ">
                <legend class="pt-0 ">Pineapple on pizza</legend>

                <input type="radio" name="score[4]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[4]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[4]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[4]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[4]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>

            <fieldset class="form-group ">
                <legend class="pt-0 ">Have you ever licked your elbow and it tasted like salt?</legend>

                <input type="radio" name="score[5]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[5]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[5]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[5]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[5]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">Did that last question make you try to lick your elbow?</legend>

                <input type="radio" name="score[6]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[6]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[6]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[6]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[6]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">This survey is nonsensical and means nothing?</legend>

                <input type="radio" name="score[7]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[7]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[7]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[7]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[7]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">You and Sonic the Hedgehog walk into a bar and you say "Hey man you look a little blue"?</legend>

                <input type="radio" name="score[8]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[8]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[8]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[8]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[8]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>


            <fieldset class="form-group ">
                <legend class="pt-0 ">You just wasted your time</legend>

                <input type="radio" name="score[9]" id="circle1" value="1" checked>
                <label class="form-check-label" for="circle1">
                    1
                </label>
                <input type="radio" name="score[9]" id="circle2" value="2">
                <label class="form-check-label" for="circle2">
                    2
                </label>
                <input type="radio" name="score[9]" id="circle3" value="3">
                <label class="form-check-label" for="circle3">
                    3
                </label>
                <input type="radio" name="score[9]" id="circle4" value="4">
                <label class="form-check-label" for="circle4">
                    4
                </label>

                <input type="radio" name="score[9]" id="circle5" value="5">
                <label class="form-check-label" for="circle5">
                    5
                </label>

            </fieldset>

            <button id="submitButton" data-toggle="modal" data-target="#modalBoi">button</button>
        </form>
    </div>



    <div class="modal fade" id="modalBoi" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="mudaMuda">Your New Best Friend</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <script>

        let newtotal = 0;
        let totalArray = [];
        let diffArray = [];




        $('#friendForm').on('submit', function (e) {
            e.preventDefault();
            $.ajax({
                method: 'POST',
                url: '/api/friends',
                data: $('#friendForm').serialize(),
                success: function () {
                    $("#friendForm")[0].reset()
                    newFriendTotal();


                }

            })

        });


        function newFriendTotal() {
            newtotal = 0;
            $.ajax({
                url: "api/friends",
                method: "GET",
            }).then(function (res) {
                for (let i = 0; i < res[res.length - 1].score.length; i++) {
                    newtotal += parseInt(res[res.length - 1].score[i]);
                }//end for
                console.log(newtotal);
                allTotatals();
            })//then
        }//func

        function allTotatals() {
            totalArray = [];
            $.ajax({
                url: "api/friends",
                method: "GET",
            }).then(function (res) {
                for (let i = 0; i < res.length - 1; i++) {
                    let total = 0


                    for (let j = 0; j < res[i].score.length; j++) {
                        total += parseInt(res[i].score[j]);

                        // total += parseInt(res[i].score[j]);
                    }//j
                    console.log(total);
                    totalArray.push(total);
                }//i
                getDiff(totalArray, newtotal);
                console.log();;
            })//then
        }//func


        function getDiff(array, value) {
            for (let i = 0; i < array.length; i++) {
                diffArray.push(Math.abs(array[i] - value))
            }
            $.ajax({
                url: "/api/friends",
                method: "GET",
            }).then(function (res) {
                let friend = res[diffArray.indexOf(Math.min(...diffArray))]
                console.log(friend);
                $(".modal-body").empty();
                $(".modal-body").append(`<p>${friend.name}`);
                $(".modal-body").append(`<img src="${friend.photo}" height="200" width="200">`);

            })
        }

    </script>


</body>

</html>